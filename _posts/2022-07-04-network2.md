---
layout : single
title : "CCNA 강의 2 : 네트워크란 ? / LAN, WAN / OSI 7 Layers (4~7계층)"
categories: Security
tag: [network]
sidebar:
    nav: "docs"
---
# TCP / IP Network (3계층 ~)
>## OSI 7 layer vs TCP/IP Model Layer

> <img src = "/images/network/networkbasic/5.jpg">

 - 3계층 : Network(Internet) Layer (네트워크 계층)<br><br>
 상위 레벨의 데이터를 데이터 종류에 상관 없이 패킷으로 캡슐화하여 (눈에 안 보임) 다른 호스트로 패킷들을 **라우팅**한다.<br>
 데이터는 패킷 안으로 캡슐화되며, 패킷의 헤더는 송신지와 수신지의 주소들을 포함하는 필드를 가진다.<br>
 즉, IP 라는 논리적 주소를 이용하여 **통신 경로를 제어하고 최종 목적지까지 어떻게 보낼 지 결정한다**<br>
 ex) <br>IP Address, ICMP, IGMP, ARP, RARP ...<br><br>
 **PDU : 패킷 (Packet)* <br>
 **기본 장비 : Router(라우터), L3-Switch* <br>
 **전송 방식 : Unicast, Multicast, Broadcast, Anycast* <br>

>> #### 3계층 프로토콜
---

 >>**ICMP (Internet Control Message Protocol)**<br><br>
 IP는 신뢰성이 보장되지 않기 (주소만 알면 보안성에 상관 없이 모든 곳을 갈 수 있음) 때문에 ICMP는 수신측에서 송신측으로 데이터의 사고 (오류내용) 에 대한 내용을 전달하는 기능을 한다.

 >>|Type|Message|
 |:------:|:---|
 |0|Echo Reply|
 |3|**Destination Unreachable** : 라우터에 문제가 있는 경우 / 도착 불가능한 사유(16가지)가 코드에 명시|
 |4|Source Quench|
 |5|redirect|
 |8|Echo Request|
 |11|**Time Exceeded** : TTL 초과|
 |12|Parameter Problem|
 |13|Timestamp Request|
 |14|Timestamp Replay|
 |15 ~ 18|정보 주고받기 : DHCP가 역할을 대신 함|
 |30|Traceroute : 해당 라우터까지의 경로 체크|

 >> Destination Unreachable <br>

 >>|Type|Message|
 |:------:|:---|
 |0|Network Unreachable|
 |1|Host Unreachable|
 |2|Protocol Unreachable|
 |3|Port Unreachable|
 |5|Source Route Failed|
 |6|Destination Network Unknown|
 |7|Destination Host Unknown|

 >> 실패라고 알려주는 것 : ICMP 프로토콜<br><br>
 > <img src = "/images/network/networkbasic/6.png">

 >>**IGMP (Internet Group Message Protocol)**<br><br>
 멀티캐스트 방식으로 주소를 그룹화하여 여러 목적지를 동시에 보낼 때 유용한 프로토콜 (224.0.0.0 to 239.255.255.255)

 >>**ARP (Address Resolution Protocol)**<br><br>
 IP주소 -> MAC주소 변환<br>
 *2계층 다룬 후에 다시 자세하게*

 >>**RARP (Reverse Address Resolution Protocol)**<br><br>
 MAC주소 -> IP 주소 변환<br>
 *2계층 다룬 후에 다시 자세하게*

>> #### 3계층 전송 방식
---
 >>**Unicast (1:1)**<br><br>
 HOST 1이 HOST 2에 데이터를 전달하는 가장 일반적인 방법으로, Souce Address와 Destination Address를 명시하여 해당하는 장비만이 데이터를 처리하는 방법이다. Host to Host 전달을 기반으로 하여, 다른 Host에 부하를 주지 않는다. 하지만, 동일한 정보를 많은 호스트에 전달 시 비효율적일 수 있다.<br><br>
 >>**Multicast (1:n)**<br><br>
 IGMP 프로토콜이 사용하는 통신 방식으로, 단일 호스트가 예약된 주소로 데이터를 전송하며, 모든 정해진 호스트는 메세지를 수신한다. 동일한 정보를 한 번에 여러 호스트에 전달할 때 장점을 가진다.

  >>|Start|End|Description|
 |:------:|:---||
 |224.0.0.0|224.0.0.255|유명한 특수 멀티캐스트 주소로 예약|
 |224.0.1.0|238.255.255.255|전역 범위 (인터넷 전체) 멀티캐스트 주소|
 |239.0.0.0|239.255.255.255|관리용(로컬) 멀티캐스트 주소|

  >>|Address|Description|
 |:------:|:---|
 |224.0.0.0|예약됨. 쓰이지 않음|
 |224.0.0.1|서브넷의 모든 장비|
 |224.0.0.2|비 서브넷의 모든 라우터|
 |224.0.0.3|예약됨|
 |224.0.0.4|DVMPR을 사용하는 모든 라우터|
 |224.0.0.5|OSPF를 사용하는 모든 라우터|
 |224.0.0.6|OSPF로 지정된 라우터|
 |224.0.0.9|RIP-2로 지정된 라우터|
 |224.0.0.11|모바일 에이전트 (모바일 IP용)|
 |224.0.0.12|DHCP 서버 / 중계 에이전트| 


 >>**Broadcast (1:all)**<br><br>
 단일 호스트가 세그먼트에 모든 호스트를 대상으로 데이터를 전달 시 사용되며, 같은 대역을 가지는 모든 호스트는 메세지를 수신한다. 많은 Broadcast는 호스트의 성능저하를 가져온다. (관계 없는 호스트도 메세지를 수신하며, 이들은 패킷을 폐기한다)<br> **only in ipv4*

 >>**Anycast**<br><br>
 거리순으로 가까운 시스템에게만 데이터를 전달<br> **only in ipv6*

 - 2계층 : Data Link Layer (데이터 링크 계층)<br><br>
 물리적 주소 기반으로 데이터의 전송형태가 결정되며, 물리적 링크로 데이터 전송 제어 역할을 한다 <br><br>
  <img src = "/images/network/networkbasic/6.jpg"><br><br>
  현재 7~5 계층에서는 따로 데이터가 붙으며 변환되지 않고, '메세지'로 통용되며, 2계층에서는 다른 계층과 다르게 header와 footer 두 개의 데이터가 붙는다.<br><br>
  ex) <br>3계층의 패킷을 MAC 주소에 실어 보내기 위해 사용<br>1계층의 매체 상에서 2계층 통신 간의 Frame 교환을 책임짐<br>패킷을 프레임(데이터와 정보가 모여있는 것)으로 캡슐화(encapsulation)하여 매체에 보내고, 매체로부터 프레임을 수신하여 다시 패킷으로 역캡슐화(decapsulation) 하는 과정을 포함(Frame-relay)<br> 
  **MAC(Media Access Control))* <br> 

  >>> 제조할 때 결정되므로, 같은 주소는 존재할 수 없으며, 주소가 겹칠 경우 통신을 통제함<br> 네트워크 매체에 접근 통제 (CSMA/CD) <br>
  ex : 이더넷 카드의 주소 <br><br>
 >><img src = "/images/network/networkbasic/7.jpg">

 >>>**PDU : 프레임 (Frame)* <br>
 **기본 장비 :Switch, 브릿지 (가상)* <br>
 **전송 방식 : Unicast, Multicast, Broadcast, Anycast* <br>
 >> #### 2계층 프로토콜
 ---

 >>**Point to Point**<br><br>
 1:1로 간섭 없이 서로 다른 장치끼리 연동 <br>
 PPP : 일대일 직렬 (1bit씩)<br>
 HDLC : 비트로 연결하여 제어 (bit들을 모아서 전송)
 